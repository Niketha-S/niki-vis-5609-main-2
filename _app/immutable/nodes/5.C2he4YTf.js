import{n as gt,a as j,t as lt}from"../chunks/DqiF99WP.js";import"../chunks/Bi2c9ZaJ.js";import{a0 as It,k as a,Y as dt,U as Qt,a6 as F,s as X,a4 as G,a8 as R,av as yt,a9 as tt,a5 as jt,a1 as ht,aJ as Zt,f as te,a7 as bt,l as ee,aK as xt}from"../chunks/DllsF_mC.js";import{s as ot}from"../chunks/BN5TdZZb.js";import{a as qt}from"../chunks/BMfMIjeu.js";import{e as pt,i as wt}from"../chunks/V1YzKkg1.js";import{b as kt}from"../chunks/Ci67RCHy.js";import{i as re}from"../chunks/DUenjkP0.js";import{o as ne}from"../chunks/BccD5po5.js";import{d as ie,i as ae,a as Xt,l as se,c as oe}from"../chunks/DUXprHVX.js";import{s as U,t as le,e as ue,m as ce,a as fe,b as he}from"../chunks/MpXQgLNm.js";import{S as me}from"../chunks/CYkNVmJk.js";import{s as L}from"../chunks/BdWRhC0o.js";import{b as Et}from"../chunks/DUdfFFCA.js";import{p as mt}from"../chunks/CYjJcxkb.js";import{l as pe}from"../chunks/Co2p4suz.js";function _e(t){let l;for(;l=t.sourceEvent;)t=l;return t}function $t(t,l){if(t=_e(t),l===void 0&&(l=t.currentTarget),l){var m=l.ownerSVGElement||l;if(m.createSVGPoint){var _=m.createSVGPoint();return _.x=t.clientX,_.y=t.clientY,_=_.matrixTransform(l.getScreenCTM().inverse()),[_.x,_.y]}if(l.getBoundingClientRect){var w=l.getBoundingClientRect();return[t.clientX-w.left-l.clientLeft,t.clientY-w.top-l.clientTop]}}return[t.pageX,t.pageY]}const Dt={capture:!0,passive:!1};function Tt(t){t.preventDefault(),t.stopImmediatePropagation()}function ge(t){var l=t.document.documentElement,m=U(t).on("dragstart.drag",Tt,Dt);"onselectstart"in l?m.on("selectstart.drag",Tt,Dt):(l.__noselect=l.style.MozUserSelect,l.style.MozUserSelect="none")}function ve(t,l){var m=t.document.documentElement,_=U(t).on("dragstart.drag",null);l&&(_.on("click.drag",Tt,Dt),setTimeout(function(){_.on("click.drag",null)},0)),"onselectstart"in m?_.on("selectstart.drag",null):(m.style.MozUserSelect=m.__noselect,delete m.__noselect)}const St=t=>()=>t;function de(t,{sourceEvent:l,target:m,selection:_,mode:w,dispatch:P}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:l,enumerable:!0,configurable:!0},target:{value:m,enumerable:!0,configurable:!0},selection:{value:_,enumerable:!0,configurable:!0},mode:{value:w,enumerable:!0,configurable:!0},_:{value:P}})}function ye(t){t.stopImmediatePropagation()}function At(t){t.preventDefault(),t.stopImmediatePropagation()}var Vt={name:"drag"},zt={name:"space"},et={name:"handle"},rt={name:"center"};const{abs:Lt,max:M,min:B}=Math;function Ot(t){return[+t[0],+t[1]]}function Ft(t){return[Ot(t[0]),Ot(t[1])]}var _t={name:"x",handles:["w","e"].map(Nt),input:function(t,l){return t==null?null:[[+t[0],l[0][1]],[+t[1],l[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},Ct={},I={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Gt={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},Kt={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},be={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},xe={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function Nt(t){return{type:t}}function we(t){return!t.ctrlKey&&!t.button}function ke(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function Ee(){return navigator.maxTouchPoints||"ontouchstart"in this}function Yt(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function Se(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function Ae(){return ze(_t)}function ze(t){var l=ke,m=we,_=Ee,w=!0,P=ie("start","brush","end"),p=6,E;function d(e){var r=e.property("__brush",nt).selectAll(".overlay").data([Nt("overlay")]);r.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",I.overlay).merge(r).each(function(){var i=Yt(this).extent;U(this).attr("x",i[0][0]).attr("y",i[0][1]).attr("width",i[1][0]-i[0][0]).attr("height",i[1][1]-i[0][1])}),e.selectAll(".selection").data([Nt("selection")]).enter().append("rect").attr("class","selection").attr("cursor",I.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var n=e.selectAll(".handle").data(t.handles,function(i){return i.type});n.exit().remove(),n.enter().append("rect").attr("class",function(i){return"handle handle--"+i.type}).attr("cursor",function(i){return I[i.type]}),e.each(V).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",K).filter(_).on("touchstart.brush",K).on("touchmove.brush",W).on("touchend.brush touchcancel.brush",Q).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}d.move=function(e,r,n){e.tween?e.on("start.brush",function(i){O(this,arguments).beforestart().start(i)}).on("interrupt.brush end.brush",function(i){O(this,arguments).end(i)}).tween("brush",function(){var i=this,u=i.__brush,h=O(i,arguments),b=u.selection,T=t.input(typeof r=="function"?r.apply(this,arguments):r,u.extent),g=ae(b,T);function N(y){u.selection=y===1&&T===null?null:g(y),V.call(i),h.brush()}return b!==null&&T!==null?N:N(1)}):e.each(function(){var i=this,u=arguments,h=i.__brush,b=t.input(typeof r=="function"?r.apply(i,u):r,h.extent),T=O(i,u).beforestart();Xt(i),h.selection=b===null?null:b,V.call(i),T.start(n).brush(n).end(n)})},d.clear=function(e,r){d.move(e,null,r)};function V(){var e=U(this),r=Yt(this).selection;r?(e.selectAll(".selection").style("display",null).attr("x",r[0][0]).attr("y",r[0][1]).attr("width",r[1][0]-r[0][0]).attr("height",r[1][1]-r[0][1]),e.selectAll(".handle").style("display",null).attr("x",function(n){return n.type[n.type.length-1]==="e"?r[1][0]-p/2:r[0][0]-p/2}).attr("y",function(n){return n.type[0]==="s"?r[1][1]-p/2:r[0][1]-p/2}).attr("width",function(n){return n.type==="n"||n.type==="s"?r[1][0]-r[0][0]+p:p}).attr("height",function(n){return n.type==="e"||n.type==="w"?r[1][1]-r[0][1]+p:p})):e.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function O(e,r,n){var i=e.__brush.emitter;return i&&(!n||!i.clean)?i:new q(e,r,n)}function q(e,r,n){this.that=e,this.args=r,this.state=e.__brush,this.active=0,this.clean=n}q.prototype={beforestart:function(){return++this.active===1&&(this.state.emitter=this,this.starting=!0),this},start:function(e,r){return this.starting?(this.starting=!1,this.emit("start",e,r)):this.emit("brush",e),this},brush:function(e,r){return this.emit("brush",e,r),this},end:function(e,r){return--this.active===0&&(delete this.state.emitter,this.emit("end",e,r)),this},emit:function(e,r,n){var i=U(this.that).datum();P.call(e,this.that,new de(e,{sourceEvent:r,target:d,selection:t.output(this.state.selection),mode:n,dispatch:P}),i)}};function K(e){if(E&&!e.touches||!m.apply(this,arguments))return;var r=this,n=e.target.__data__.type,i=(w&&e.metaKey?n="overlay":n)==="selection"?Vt:w&&e.altKey?rt:et,u=t===Ct?null:be[n],h=t===_t?null:xe[n],b=Yt(r),T=b.extent,g=b.selection,N=T[0][0],y,k,s=T[0][1],o,c,x=T[1][0],v,C,H=T[1][1],Y,D,S=0,A=0,vt,ut=u&&h&&w&&e.shiftKey,ct,ft,$=Array.from(e.touches||[e],f=>{const z=f.identifier;return f=$t(f,r),f.point0=f.slice(),f.identifier=z,f});Xt(r);var it=O(r,arguments,!0).beforestart();if(n==="overlay"){g&&(vt=!0);const f=[$[0],$[1]||$[0]];b.selection=g=[[y=t===Ct?N:B(f[0][0],f[1][0]),o=t===_t?s:B(f[0][1],f[1][1])],[v=t===Ct?x:M(f[0][0],f[1][0]),Y=t===_t?H:M(f[0][1],f[1][1])]],$.length>1&&Z(e)}else y=g[0][0],o=g[0][1],v=g[1][0],Y=g[1][1];k=y,c=o,C=v,D=Y;var Mt=U(r).attr("pointer-events","none"),at=Mt.selectAll(".overlay").attr("cursor",I[n]);if(e.touches)it.moved=Pt,it.ended=Rt;else{var Bt=U(e.view).on("mousemove.brush",Pt,!0).on("mouseup.brush",Rt,!0);w&&Bt.on("keydown.brush",Jt,!0).on("keyup.brush",Wt,!0),ge(e.view)}V.call(r),it.start(e,i.name);function Pt(f){for(const z of f.changedTouches||[f])for(const st of $)st.identifier===z.identifier&&(st.cur=$t(z,r));if(ut&&!ct&&!ft&&$.length===1){const z=$[0];Lt(z.cur[0]-z[0])>Lt(z.cur[1]-z[1])?ft=!0:ct=!0}for(const z of $)z.cur&&(z[0]=z.cur[0],z[1]=z.cur[1]);vt=!0,At(f),Z(f)}function Z(f){const z=$[0],st=z.point0;var J;switch(S=z[0]-st[0],A=z[1]-st[1],i){case zt:case Vt:{u&&(S=M(N-y,B(x-v,S)),k=y+S,C=v+S),h&&(A=M(s-o,B(H-Y,A)),c=o+A,D=Y+A);break}case et:{$[1]?(u&&(k=M(N,B(x,$[0][0])),C=M(N,B(x,$[1][0])),u=1),h&&(c=M(s,B(H,$[0][1])),D=M(s,B(H,$[1][1])),h=1)):(u<0?(S=M(N-y,B(x-y,S)),k=y+S,C=v):u>0&&(S=M(N-v,B(x-v,S)),k=y,C=v+S),h<0?(A=M(s-o,B(H-o,A)),c=o+A,D=Y):h>0&&(A=M(s-Y,B(H-Y,A)),c=o,D=Y+A));break}case rt:{u&&(k=M(N,B(x,y-S*u)),C=M(N,B(x,v+S*u))),h&&(c=M(s,B(H,o-A*h)),D=M(s,B(H,Y+A*h)));break}}C<k&&(u*=-1,J=y,y=v,v=J,J=k,k=C,C=J,n in Gt&&at.attr("cursor",I[n=Gt[n]])),D<c&&(h*=-1,J=o,o=Y,Y=J,J=c,c=D,D=J,n in Kt&&at.attr("cursor",I[n=Kt[n]])),b.selection&&(g=b.selection),ct&&(k=g[0][0],C=g[1][0]),ft&&(c=g[0][1],D=g[1][1]),(g[0][0]!==k||g[0][1]!==c||g[1][0]!==C||g[1][1]!==D)&&(b.selection=[[k,c],[C,D]],V.call(r),it.brush(f,i.name))}function Rt(f){if(ye(f),f.touches){if(f.touches.length)return;E&&clearTimeout(E),E=setTimeout(function(){E=null},500)}else ve(f.view,vt),Bt.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);Mt.attr("pointer-events","all"),at.attr("cursor",I.overlay),b.selection&&(g=b.selection),Se(g)&&(b.selection=null,V.call(r)),it.end(f,i.name)}function Jt(f){switch(f.keyCode){case 16:{ut=u&&h;break}case 18:{i===et&&(u&&(v=C-S*u,y=k+S*u),h&&(Y=D-A*h,o=c+A*h),i=rt,Z(f));break}case 32:{(i===et||i===rt)&&(u<0?v=C-S:u>0&&(y=k-S),h<0?Y=D-A:h>0&&(o=c-A),i=zt,at.attr("cursor",I.selection),Z(f));break}default:return}At(f)}function Wt(f){switch(f.keyCode){case 16:{ut&&(ct=ft=ut=!1,Z(f));break}case 18:{i===rt&&(u<0?v=C:u>0&&(y=k),h<0?Y=D:h>0&&(o=c),i=et,Z(f));break}case 32:{i===zt&&(f.altKey?(u&&(v=C-S*u,y=k+S*u),h&&(Y=D-A*h,o=c+A*h),i=rt):(u<0?v=C:u>0&&(y=k),h<0?Y=D:h>0&&(o=c),i=et),at.attr("cursor",I[n]),Z(f));break}default:return}At(f)}}function W(e){O(this,arguments).moved(e)}function Q(e){O(this,arguments).ended(e)}function nt(){var e=this.__brush||{selection:null};return e.extent=Ft(l.apply(this,arguments)),e.dim=t,e}return d.extent=function(e){return arguments.length?(l=typeof e=="function"?e:St(Ft(e)),d):l},d.filter=function(e){return arguments.length?(m=typeof e=="function"?e:St(!!e),d):m},d.touchable=function(e){return arguments.length?(_=typeof e=="function"?e:St(!!e),d):_},d.handleSize=function(e){return arguments.length?(p=+e,d):p},d.keyModifiers=function(e){return arguments.length?(w=!!e,d):w},d.on=function(){var e=P.on.apply(P,arguments);return e===P?d:e},d}function Ut(t,l,m){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+l)/6,(t._y0+4*t._y1+m)/6)}function Ht(t){this._context=t}Ht.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Ut(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,l){switch(t=+t,l=+l,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,l):this._context.moveTo(t,l);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Ut(this,t,l);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=l}};function Ce(t){return new Ht(t)}var Ye=gt('<circle r="3" fill="red"></circle>'),De=gt('<text text-anchor="middle"> </text>'),Te=gt('<text text-anchor="middle">Brush to select a range</text>'),Ne=gt('<svg class="line svelte-1e6h4yb"><path fill="none" stroke="black" stroke-width="2"></path><g class="points"></g><g></g><g></g><g class="brush svelte-1e6h4yb"></g><text text-anchor="middle">Number of Movies by Year:</text><!></svg>');function Me(t,l){It(l,!0);let m=mt(l,"data",19,()=>[]),_=mt(l,"yearRange",15),w=mt(l,"height",3,150),P=mt(l,"width",3,600);const p={top:15,bottom:50,left:30,right:10};let E={top:p.top,right:P()-p.right,bottom:w()-p.bottom,left:p.left};const d=dt(()=>le().domain(ue(m().map(s=>new Date(s.x)))).range([E.left,E.right])),V=dt(()=>se().domain([0,ce(m(),s=>s.y)||10]).range([E.bottom,E.top])),O=pe().x(s=>a(d)(new Date(s.x))).y(s=>a(V)(s.y)).curve(Ce),q=dt(()=>()=>O(m())||"");let K=yt(void 0),W=yt(void 0),Q=yt(void 0);function nt(){!a(d)||!a(V)||(U(a(K)).call(fe(a(d))),U(a(W)).call(he(a(V))))}function e(s){const o=s.selection;if(o){const[c,x]=o.map(a(d).invert);_([c,x])}else _(void 0)}function r(){const s=Ae().extent([[E.left,E.top],[E.right,E.bottom]]).on("brush end",e);U(a(Q)).call(s)}Qt(()=>{r(),nt()});var n=Ne(),i=F(n),u=X(i);pt(u,21,m,s=>s.x,(s,o)=>{var c=Ye();G((x,v)=>{L(c,"cx",x),L(c,"cy",v)},[()=>a(d)(new Date(a(o).x)),()=>a(V)(a(o).y)]),j(s,c)}),R(u);var h=X(u);Et(h,s=>tt(K,s),()=>a(K));var b=X(h);Et(b,s=>tt(W,s),()=>a(W));var T=X(b);Et(T,s=>tt(Q,s),()=>a(Q));var g=X(T),N=X(g);{var y=s=>{var o=De(),c=F(o);R(o),G((x,v)=>{L(o,"x",P()/2),L(o,"y",w()-20),ot(c,`${x??""} - ${v??""}`)},[()=>_()[0].getFullYear(),()=>_()[1].getFullYear()]),j(s,o)},k=s=>{var o=Te();G(()=>{L(o,"x",P()/2),L(o,"y",w()-20)}),j(s,o)};qt(N,s=>{_()?s(y):s(k,!1)})}R(n),G(()=>{L(n,"width",P()),L(n,"height",w()),L(i,"d",a(q)),L(h,"transform",`translate(0, ${E.bottom??""})`),L(b,"transform",`translate(${E.left}, 0)`),L(g,"x",P()/2),L(g,"y",w()-5)}),j(t,n),jt()}var Be=lt("<option> </option>"),Pe=lt("<option> </option>"),Re=lt("<option> </option>"),Xe=lt('<div class="selectors svelte-a9n7ci"><label>X Axis: <select class="svelte-a9n7ci"></select></label> <label>Y Axis: <select class="svelte-a9n7ci"></select></label> <label>Size: <select class="svelte-a9n7ci"></select></label></div> <!> <br> <!>',1),$e=lt('<div class="container svelte-a9n7ci"><h1>Summer Movies</h1> <p> </p> <!></div>');function er(t,l){It(l,!1);let m=ht([]),_=ht(),w=ht([]);function P(e){let r={};e.forEach(i=>{const u=i.year.getFullYear();r[u]=(r[u]||0)+1});let n=Object.entries(r).map(([i,u])=>({x:new Date(Number(i),0,1).getTime(),y:u})).sort((i,u)=>i.x-u.x);return console.log("Processed Year Count Data:",n),n}let p=ht({x:"year",y:"average_rating",size:"num_votes"});const E=["tconst","title_type","primary_title","original_title","year","runtime_minutes","genres","simple_title","average_rating","num_votes"];async function d(){try{const r=await oe("./summer_movies.csv");tt(m,r.map(n=>({tconst:n.tconst,title_type:n.title_type,primary_title:n.primary_title,original_title:n.original_title,year:new Date(Number(n.year),0,1),runtime_minutes:Number(n.runtime_minutes),genres:n.genres.split(","),simple_title:n.primary_title.toLowerCase(),average_rating:Number(n.average_rating),num_votes:Number(n.num_votes)}))),tt(w,P(a(m))),console.log("Loaded CSV Data:",a(m)),console.log("Final Year Count Array:",a(w)),await Zt()}catch(e){console.error("Error loading CSV:",e)}}ne(d);function V(e,r){alert(`Clicked on: ${r.primary_title} (${r.year.getFullYear()}) - Rating: ${r.average_rating}`)}function O(e){tt(_,e)}re();var q=$e(),K=X(F(q),2),W=F(K,!0);R(K);var Q=X(K,2);{var nt=e=>{var r=Xe(),n=te(r),i=F(n),u=X(F(i));G(()=>{a(p),bt(()=>{})}),pt(u,5,()=>E,wt,(s,o)=>{var c=Be(),x={},v=F(c,!0);R(c),G(()=>{x!==(x=a(o))&&(c.value=(c.__value=a(o))==null?"":a(o)),ot(v,a(o))}),j(s,c)}),R(u),R(i);var h=X(i,2),b=X(F(h));G(()=>{a(p),bt(()=>{})}),pt(b,5,()=>E,wt,(s,o)=>{var c=Pe(),x={},v=F(c,!0);R(c),G(()=>{x!==(x=a(o))&&(c.value=(c.__value=a(o))==null?"":a(o)),ot(v,a(o))}),j(s,c)}),R(b),R(h);var T=X(h,2),g=X(F(T));G(()=>{a(p),bt(()=>{})}),pt(g,5,()=>E,wt,(s,o)=>{var c=Re(),x={},v=F(c,!0);R(c),G(()=>{x!==(x=a(o))&&(c.value=(c.__value=a(o))==null?"":a(o)),ot(v,a(o))}),j(s,c)}),R(g),R(T),R(n);var N=X(n,2);const y=ee(()=>a(_)?a(m).filter(s=>s.year>=a(_)[0]&&s.year<=a(_)[1]):a(m));me(N,{get movies(){return a(y)},get x(){return a(p).x},get y(){return a(p).y},get size(){return a(p).size},$$events:{click:V}});var k=X(N,4);Me(k,{get data(){return a(w)},stroke:"black","stroke-width":"2",get yearRange(){return a(_)},set yearRange(s){tt(_,s)},$$events:{brush:O},$$legacy:!0}),kt(u,()=>a(p).x,s=>xt(p,a(p).x=s)),kt(b,()=>a(p).y,s=>xt(p,a(p).y=s)),kt(g,()=>a(p).size,s=>xt(p,a(p).size=s)),j(e,r)};qt(Q,e=>{a(m).length>0&&e(nt)})}R(q),G(()=>ot(W,a(m).length===0?"Loading...":`${a(m).length} movies`)),j(t,q),jt()}export{er as component};
